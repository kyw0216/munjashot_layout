<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>마이 페이지</title>

    <meta name='viewport' content='width=device-width, initial-scale=1'>

    <script src="../javascript/external/jquery-3.5.1.min.js"></script>
    <script src="../javascript/external/jquery-ui.min.js"></script>
    <script src="../javascript/Common/modal.js"></script>

    <link rel='stylesheet' type='text/css' media='screen' href='../stylesheet/Common/common.css'>
    <link rel='stylesheet' type='text/css' media='screen' href='../stylesheet/Common/base.css'>

    <script src='../javascript/base/util.js'></script>

    <!-- Excel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.1/xlsx.full.min.js"></script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/xeicon@2.3.3/xeicon.min.css">
    <link rel="stylesheet" href="../stylesheet/external/font-awesome.css">
    <link rel="stylesheet" href="../stylesheet/external/font-awesome-regular.min.css">
    <link rel="stylesheet" href="../stylesheet/external/font-awesome-solid.min.css">

    <script src="../javascript/external/swiper-4.5.1.min.js"></script>
    <link rel="stylesheet" href="../stylesheet/external/swiper-4.5.1.min.css">

    <!-- uiToast CDN -->
    <link rel="stylesheet" href="https://uicdn.toast.com/grid/latest/tui-grid.css" />
    <link rel="stylesheet" href="https://uicdn.toast.com/tui.pagination/latest/tui-pagination.css" />
    <link rel="stylesheet" href="https://uicdn.toast.com/tui.date-picker/latest/tui-date-picker.css" />
    <script src="https://uicdn.toast.com/tui.code-snippet/v1.5.0/tui-code-snippet.js"></script>
    <script src="https://uicdn.toast.com/tui.pagination/latest/tui-pagination.js"></script>
    <script src="https://uicdn.toast.com/tui.date-picker/latest/tui-date-picker.js"></script>
    <script src="https://uicdn.toast.com/grid/latest/tui-grid.js"></script>


    <!-- Moment -->
    <script src="../javascript/external/moment-2.29.1-locale.min.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            $("#header").load("header.html"); //헤더 인클루드
            $("#footer").load("footer.html"); //푸터부분 인클루드
            $("#leftBar_div").load("leftBar.html"); //푸터부분 인클루드
            $("#rightBar_div").load("rightBar.html"); //푸터부분 인클루드
        });
    </script>

</head>

<body>

    <!-- Header -->
    <div id="header"></div>
    <!-- <div data-include-path="header.html"></div> -->

    <!-- Body -->

    <link rel='stylesheet' type='text/css' media='screen' href='../stylesheet/Page/myPage-fax.css'>
    <script src='../javascript/Page/myPage-fax.js'></script>

    <div id="main-body-wrapper" style="min-height: 50% !important;">
        <div id="main-body" style="display: flex; justify-content: center; align-items: center;">
            <main class="body-section">

                <div class="main_content main_content1">
                    <div class="wrapper clearfix">

                        <div class="content_wrapper">

                            <div class="column_wrapper">
                                <div class="row_wrapper" style="justify-content: flex-start;">
                                    <div class="row_wrapper" style="justify-content: flex-start; margin:0;">
                                        <span style="font-size:28px;">받은 팩스함</span>
                                    </div>
                                    <div class="row_wrapper" style="justify-content: flex-end; margin:0;">
                                        <button class="btn" onclick="javascript:location.href='myPage-fax-receive.html';">수신번호 사용내역</button>
                                    </div>
                                </div>
                                
                            </div>
                            
                            <hr style="margin:12px;width: 100%;">

                            <div class="column_wrapper" style="align-items: flex-start; justify-content: center; line-height: normal;">
                                <div class="row_wrapper" style="justify-content: flex-start; margin:0;">
                                    <span>새로 받은 팩스 : 0 건</span>
                                    <button class="btn btn-modal" id="btn-modal" data-modal="modal-fax-alim-mng" style="margin-left:20px;">팩스 수신 알림서비스</button>
                                </div>

                                <br>
                                
                                <span>수신 번호 : 02-0000-0000</span>

                                <div class="row_wrapper" style="justify-content: flex-start; margin:0;">
                                    <span>수신 기간 : 2021-00-00 ~ 2021-00-00</span>
                                    <button class="btn" style="margin-left:20px;" onclick="javscript:location.href='myPage-fax-receive-extend.html'">연장하기</button>
                                </div>

                            </div>

                            <hr style="margin:12px;width: 100%;">
                            
                            <div class="row_wrapper" style="justify-content: flex-start;">
                                <div class="row" style="justify-content: flex-start; width: 30%; margin:0;">
                                    <span style="width:60px;">검색 월</span>
                                    
                                    <select style="margin-left:10px; width:100px;">
                                        <option>2022 년</option>
                                        <option>2021 년</option>
                                        <option>2020 년</option>
                                        <option>2019 년</option>
                                    </select>

                                    <select style="margin-left:10px; width:100px;">
                                        <option>01월</option>
                                        <option>02월</option>
                                        <option>03월</option>
                                        <option>04월</option>
                                        <option>05월</option>
                                        <option>06월</option>
                                        <option>07월</option>
                                        <option>08월</option>
                                        <option>09월</option>
                                        <option>10월</option>
                                        <option>11월</option>
                                        <option>12월</option>
                                    </select>
                                </div>
                                
                                <div class="row" style="justify-content: flex-end; margin:0;">
                                    <select style="margin-left:10px; width:150px;">
                                        <option>관리제목</option>
                                        <option>발신번호</option>
                                        <option>이름</option>
                                    </select>
                                    
                                    <input type="search" placeholder="관리제목, 발신번호, 이름" style="margin-left:10px;">

                                    <button class="btn" style="margin-left:10px;">검색</button>
                                </div>

                            </div>
                             
                            <div class="row" style="justify-content: flex-end;">
                                <button class="btn" style="margin-left:10px;">엑셀 다운로드</button>
                            </div>
                             
                            <div class="row">
                                <div id="grid" style="width:100%;"></div>
                            </div>
                            

                            <div class="row_wrapper" style="justify-content: flex-end;">
                                <button class="btn">선택 삭제</button>
                                <button class="btn" style="margin-left:10px;">전체 삭제</button>
                            </div>
                            
                            <div class="row_wrapper" style="height:auto;">
                                <span>1/2/3 .... /10</span>
                            </div>

                        </div>
                        
                    </div>

                </div>

            </main>
        </div>
    </div>

    <div id="modal" class="modal-overlay">
        <div class="modal-window">
            <div class="title">
                <h2>모달</h2>
            </div>
            <div class="close-area">X</div>
            <div class="content" style="display: flex; justify-content: center; align-items: center;">
                <p>모달입니다.</p>
            </div>
        </div>
    </div>

    <!-- leftBar -->
    <div id="leftBar_div"></div>

    <!-- rightBar -->
    <div id="rightBar_div"></div>

    <!-- Footer -->
    <div id="footer"></div>
    <!-- <div data-include-path="footer.html"></div> -->
</body>

<script>

    let grid_Date = moment("2022-05-01");
    // console.log(grid_Date.format("YYYY-MM-DD"));
    // console.log(grid_Date.add(1, "day").format("YYYY-MM-DD"));

    const gridData = [];

    gridData.push({
                receive_time: grid_Date.format("YYYY-MM-DD HH:mm"),
                // fax_mng_name: `<button class="btn" style="margin-left:10px; padding:3px;">저장</button>`,
                fax_mng_name: `관리제목`,
                callnum: `02-001-0000`,
                name: `엠포플러스`,
                view: `<button class="btn" onclick="util.alert('팩스보기', 'success', '1번째 팩스');" style="padding:3px;">팩스보기</button><i class="fa-solid fa-download" style="margin-left: 10px; font-size:20px; cursor:pointer;"></i>`,
            });
            
            (function() {
                for(let i = 1; i < 30; i++){
            gridData.push({
                receive_time: grid_Date.add(1, "day").format("YYYY-MM-DD HH:mm"),
                // fax_mng_name: `<button class="btn" style="margin-left:10px; padding:3px;">저장</button>`,
                fax_mng_name: `관리제목${i+1}`,
                callnum: `02-00${i+1}-0000`,
                name: `엠포플러스${i+1}`,
                view: `<button class="btn" onclick="util.alert('팩스보기${i+1}', 'success', '${i+1}번째 팩스');" style="padding:3px;">팩스보기</button><i class="fa-solid fa-download" style="margin-left: 10px; font-size:20px; cursor:pointer;"></i>`,
            });
        }
    })();

    class CustomTextEditor {
        constructor(props) {
            const el = document.createElement('input');
            const { maxLength } = props.columnInfo.editor.options;

            el.type = 'text';
            el.maxLength = maxLength;
            el.value = String(props.value);

            this.el = el;
        }

        getElement() {
            return this.el;
        }

        getValue() {
            return this.el.value;
        }

        mounted() {
            this.el.select();
        }
    }

    class RowNumberRenderer {
        constructor(props) {
            const el = document.createElement('span');
            el.innerHTML = `No.${props.formattedValue}`;
            this.el = el;
        }

        getElement() {
            return this.el;
        }

        render(props) {
            this.el.innerHTML = `No.${props.formattedValue}`;
        }
    }
    
    class CheckboxRenderer {
        constructor(props) {
            const { grid, rowKey } = props;

            const label = document.createElement('label');
            label.className = 'checkbox tui-grid-row-header-checkbox';
            label.setAttribute('for', String(rowKey));

            const hiddenInput = document.createElement('input');
            hiddenInput.className = 'hidden-input';
            hiddenInput.id = String(rowKey);

            const customInput = document.createElement('span');
            customInput.className = 'custom-input';

            label.appendChild(hiddenInput);
            label.appendChild(customInput);

            hiddenInput.type = 'checkbox';
            label.addEventListener('click', (ev) => {
                ev.preventDefault();

                if (ev.shiftKey) {
                    grid[!hiddenInput.checked ? 'checkBetween' : 'uncheckBetween'](rowKey);
                    return;
                }

                grid[!hiddenInput.checked ? 'check' : 'uncheck'](rowKey);
            });

            this.el = label;

            this.render(props);
        }

        getElement() {
            return this.el;
        }

        render(props) {
            const hiddenInput = this.el.querySelector('.hidden-input');
            const checked = Boolean(props.value);

            hiddenInput.checked = checked;
        }
    }


    const Grid = tui.Grid;
    const option = {
        el: document.getElementById('grid'), // Container element
        data: gridData,
        scrollX: false,
        scrollY: false,
        minBodyHeight: 30,
        rowHeaders: [
        {
            type: 'rowNum',
            renderer: {
                type: RowNumberRenderer
            }
        },
        {
            type: 'checkbox',
            header: `
            <label for="all-checkbox" class="checkbox">
                <input type="checkbox" id="all-checkbox" class="hidden-input" name="_checked" />
                <span class="custom-input"></span>
            </label>
            `,
            renderer: {
                type: CheckboxRenderer
            }
        }],
        pageOptions: {
            useClient: true,
            perPage: 10
        },
        columns: [
            {
                header: '수신시각',
                name: 'receive_time',
                align: 'center',
            },
            {
                header: '관리제목',
                name: 'fax_mng_name',
                align: 'center',
                editor: {
                    type: CustomTextEditor,
                    options: {
                        maxLength: 100
                    }
                }
            },
            {
                header: '발신번호',
                name: 'callnum',
                align: 'center',
            },
            {
                header: '이름',
                name: 'name',
                align: 'center',
            },
            {
                header: '보기',
                name: 'view',
                align: 'center',
            },
        ],
        contextMenu: ({ rowKey, columnName }) => (
            [
                [
                    {
                        name: 'export',
                        label: 'Export',
                        subMenu: [
                            {
                                name: 'default',
                                label: '전체 export',
                                subMenu: [
                                    {
                                        name: 'csvExport',
                                        label: 'CSV export',
                                        action: () => {
                                            instance.export('csv');
                                        }
                                    },
                                    {
                                        name: 'excelExport',
                                        label: 'Excel export',
                                        action: () => {
                                            instance.export('xlsx');
                                        }
                                    },
                                ]
                            },
                            {
                                name: 'includeHeader',
                                label: '헤더를 제외하고 export',
                                subMenu: [
                                    {
                                        name: 'csvExport',
                                        label: 'CSV export',
                                        action: () => {
                                            instance.export('csv', { includeHeader: false });
                                        }
                                    },
                                    {
                                        name: 'excelExport',
                                        label: 'Excel export',
                                        action: () => {
                                            instance.export('xlsx', { includeHeader: false });
                                        }
                                    },
                                ]
                            },
                            {
                                name: 'onlySelected',
                                label: '선택한 영역 export',
                                subMenu: [
                                    {
                                        name: 'csvExport',
                                        label: 'CSV export',
                                        action: () => {
                                            instance.export('csv', { onlySelected: true });
                                        }
                                    },
                                    {
                                        name: 'excelExport',
                                        label: 'Excel export',
                                        action: () => {
                                            instance.export('xlsx', { onlySelected: true });
                                        }
                                    },
                                ]
                            },
                        ],
                    }
                ],
            ]
        )
    }

    const instance = new Grid(option);

    // instance.resetData(newData); // Call API of instance's public method

    Grid.applyTheme('striped'); // Call API of static method

    // const rowData = [
    //     {
    //         date: "2022-05-01",
    //         sms_success: 0,
    //         lms_success: 0,
    //         mms_success: 0,
    //         msg_success_sum: 0,
    //         msg_fail_sum: 0,
    //         all_sum: 0,
    //     }
    // ];
    //     rowData.forEach(row => {
    //     instance.appendRow(row);
    // });
    

    instance.on('check', function(ev) {
        console.log('check', ev);
    });

    instance.on('uncheck', function(ev) {
        console.log('uncheck', ev);
    });

</script>

</html>